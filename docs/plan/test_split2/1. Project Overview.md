## 1. Project Overview

### 1.1 Purpose

#### 1.1.1 Problem Statement

AshTrail provides a **local-first, transparent, and controllable logging system** for personal substance usage (initially smoking/vaping), with accurate timestamps, structured metadata, and long-term analyticsâ€”without relying on opaque third-party tracking apps or cloud-only data silos.

The project prioritizes **data correctness, ownership, and auditability** over social, gamified, or wellness-coaching features.

##### 1.1.1.1 User Pain Points

- Existing habit-tracking apps:
  - Hide or abstract raw data
  - Do not support offline-first operation
  - Make exporting or inspecting full datasets difficult
- Cloud-only solutions:
  - Risk data loss or lock-in
  - Obscure sync behavior and conflict resolution
- Manual tracking:
  - Is error-prone
  - Loses temporal accuracy
  - Does not scale to long-term analysis
- Multi-account scenarios:
  - Are poorly handled or unsupported
  - Often assume a single global identity

###### 1.1.1.1.1 Limitations of Existing Solutions

- No deterministic local source of truth
- Limited schema extensibility
- Analytics derived from transformed data rather than raw events
- Inability to trace how a specific data point was recorded, stored, and synced

---

### 1.2 High-Level Goals

#### 1.2.1 Offline-First Logging

- All logs must be creatable, viewable, and queryable **without network access**
- Local persistence is authoritative
- Cloud sync is additive and optional

#### 1.2.2 Multi-Account Support

- Support multiple user accounts on a single device
- Each account has:
  - Independent local storage
  - Independent sync state
  - No implicit data sharing
- Account switching must not mutate or merge data

#### 1.2.3 Data Ownership & Transparency

- Users can:
  - Inspect raw logs
  - Understand derived analytics
  - Export data in structured formats
- No hidden aggregation, scoring, or normalization without explicit definition

---

### 1.3 Non-Goals

#### 1.3.1 Explicitly Out-of-Scope Features

The following are explicitly not goals of AshTrail:

- Social feeds or sharing
- Health or medical advice
- Addiction treatment or coaching
- AI-driven behavioral recommendations
- Gamification (streaks, rewards, badges)

---

### 1.4 Target Users

#### 1.4.1 Single-User Assumptions

- Primary use case is a single individual per account
	- No collaborative or shared logging
- Data models assume:
	- One logical owner per dataset
	- No concurrent multi-device edits (conflicts handled conservatively)
##### Assumptions
- Multi-user analytics or shared timelines are not required.

---

### 1.5 Architectural Principles

#### 1.5.1 Offline-First
- Local database is the system of record
- Network availability must not affect core functionality
- Sync processes must be resumable and idempotent

#### 1.5.2 Deterministic State
- Application state must be derivable from:
	- Stored data
	- Explicit user actions
- No hidden background mutations
- Same inputs must always yield the same outputs

#### 1.5.3 Explicit Data Models

- All persisted data has:
	- Defined schema
	- Typed fields
	- Clear ownership and lifecycle
- Derived data must reference its source inputs
- Migrations must be explicit and versioned

---

### Open Questions / Assumptions to Validate

##### Assumptions

- Smoking/vaping is the only intended log category.
- Firestore is the planned remote backend unless an alternative free option becomes available.
- Users can perform CRUD operations on all log data.
- Cross-device concurrent editing support is very low priority.

##### Open Questions
- If logs are editable (CRUD), what is the required audit behavior?
	- Last-write-wins with optional metadata.
- If Firestore changes, what is the portability requirement?
	- Abstracted remote adapter
- If cross-device edits occur despite low priority, what is the minimum acceptable conflict behavior?
	- Last-write-wins
#### Open Questions / Validation Needed

- "No concurrent multi-device edits (conflicts handled conservatively)" conflicts with "cross-device concurrent editing is very low priority" (not necessarily "not supported"). Cross-device edits are:
	- Allowed but handled minimally (best-effort conflict strategy).
